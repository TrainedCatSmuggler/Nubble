<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nubble</title>
	<link rel="icon" type="image/x-icon" href="https://nubbysnumberfactory.wiki.gg/images/Site-favicon.ico">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

		@font-face {
			font-family: 'Nubby Font';
			src: url('assets/comic.ttf') format('truetype');
		}

        body {
            font-family: 'Nubby Font';
            background: url('https://nubbysnumberfactory.wiki.gg/images/Background_Dark.jpg') center/cover fixed;
            color: #ffffff;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }

        header {
            width: 100%;
            max-width: 800px;
            padding: 20px 0;
            margin-bottom: 20px;
        }

        h1 {
            text-align: center;
            font-size: 36px;
            font-weight: normal;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            text-align: center;
            font-size: 14px;
            margin-top: 5px;
            opacity: 0.9;
        }

        .game-container {
			background: rgba(155, 0, 255, 0.1);
			backdrop-filter: blur(10px);
			border: 2px solid rgba(255, 0, 255, 0.3);
			border-radius: 15px;
			padding: 30px;
			width: 100%;
			max-width: 800px;
			box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
			overflow: visible;
		}
		
        .search-container {
            position: relative;
            margin-bottom: 30px;
        }

        #searchInput {
            width: 100%;
            padding: 15px;
            font-size: 18px;
            font-family: 'Nubby Font';
            border: 2px solid rgba(255, 0, 255, 0.3);
            border-radius: 10px;
            background: rgba(155, 0, 255, 0.1);
            color: #fff;
            outline: none;
        }

        #searchInput:focus {
            border-color: #9900ff;
        }

        .dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: rgba(18, 2, 28, 1);
            border: 2px solid rgba(255, 0, 255, 0.3);
            border-radius: 10px;
            margin-top: 5px;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            z-index: 100;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        }

        .dropdown.show {
            display: block;
        }

        .dropdown-item {
            padding: 12px 15px;
            cursor: pointer;
            color: #fff;
            border-bottom: 2px solid rgba(255, 0, 255, 0.3);
            transition: background-color 0.2s;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .dropdown-item:hover {
            background-color: rgba(255, 0, 255, 0.3);
        }

        .dropdown-item:last-child {
            border-bottom: none;
        }

        .dropdown-item-icon {
            width: 40px;
            height: 40px;
            border-radius: 6px;
            object-fit: contain;
            background: rgba(0, 0, 0, 0.05);
            padding: 4px;
            flex-shrink: 0;
        }

        .guesses-container {
			margin-bottom: 20px;
		}

        .guess-row {
			display: grid;
			grid-template-columns: 80px 2fr 1fr 1fr 1fr 1fr;
			gap: clamp(3px, 1vw, 10px);
			margin-bottom: 10px;
			padding: 15px;
			background: rgba(155, 0, 255, 0.3);
			border: 2px solid rgba(255, 0, 255, 0.3);
			border-radius: 10px;
			animation: slideIn 0.3s ease;
		}

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .guess-cell {
			padding: 12px;
			border-radius: 8px;
			text-align: center;
			font-weight: normal;
			transition: all 0.3s ease;
			display: flex;
			align-items: center;
			justify-content: center;
			min-height: 64px;
			font-size: clamp(10px, 1.5vw, 16px);
			word-wrap: break-word;
			overflow-wrap: break-word;
		}

        .item-name {
			font-size: clamp(12px, 2vw, 16px);
			align-items: center;
			justify-content: center;
		}

        .item-icon {
            width: 64px;
            height: 64px;
            border-radius: 8px;
            object-fit: contain;
            background: transparent;
            padding: 4px;
            display: block;
        }

        .item-icon-placeholder {
            width: 64px;
            height: 64px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #666;
            text-align: center;
            padding: 4px;
        }

        .guess-cell.correct {
            background-color: rgba(0, 255, 0, 0.6);
			border: 2px solid rgba(0, 255, 0, 0.3);
        }

        .guess-cell.incorrect {
            background-color: rgba(255, 255, 255, 0.2);
			border: 2px solid rgba(255, 0, 255, 0.3);
            
        }

        .guess-cell.close {
            background-color: rgba(255, 255, 0, 0.6);
			border: 2px solid rgba(255, 255, 0, 0.3);
            
        }

        .guess-header {
			display: grid;
			grid-template-columns: 80px 2fr 1fr 1fr 1fr 1fr;
			gap: 10px;
			margin-bottom: 10px;
			padding: 10px 15px;
			font-weight: normal;
			font-size: 14px;
			opacity: 0.9;
		}

        .guess-header > div {
			text-align: center;
			font-size: clamp(10px, 2vw, 14px);
		}

        .message {
            position: fixed;
            top: 100px;
            background-color: rgba(255, 255, 255, 0.6);
			border: 2px solid rgba(255, 255, 255, 0.3);
            color: #000;
            padding: 16px 24px;
            border-radius: 10px;
            font-weight: normal;
            opacity: 0;
            transform: translateY(-20px);
            transition: all 0.3s ease;
            pointer-events: none;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }

        .message.show {
            opacity: 1;
            transform: translateY(0);
        }

        .message.win {
            background-color: rgba(0, 255, 0, 0.6);
			border: 2px solid rgba(0, 255, 0, 0.3);
			color: white;
        }

        .message.lose {
            background-color: rgba(255, 0, 0, 0.6);
			border: 2px solid rgba(255, 0, 0, 0.3);
			color: white;
        }

        .new-game-btn {
            width: 100%;
            padding: 15px;
            color: white;
            border-radius: 10px;
            font-size: 18px;
            font-family: 'Nubby Font';
            font-weight: normal;
            cursor: pointer;
            transition: background 0.2s;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
			border: 2px solid rgba(0, 255, 0, 0.3);
            background: rgba(0, 255, 0, 0.6);
        }

        .new-game-btn:hover {
            background: rgba(0, 255, 0, 0.8);
        }

        .attempts {
            text-align: center;
            font-size: 18px;
            margin-bottom: 20px;
            font-weight: normal;
        }

        .toggles-container {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .toggle-item {
			display: flex;
			align-items: center;
			gap: 8px;
			background: rgba(155, 0, 255, 0.1);
			border: 2px solid rgba(255, 0, 255, 0.3);
			padding: 10px 15px;
			border-radius: 8px;
			cursor: pointer;
			transition: background 0.2s;
			user-select: none;
		}

        .toggle-item:hover {
			background: rgba(155, 0, 255, 0.3);
		}

		.toggle-item input[type="checkbox"] {
			width: 18px;
			height: 18px;
			cursor: pointer;
			pointer-events: none;
		}

		.toggle-item label {
			cursor: pointer;
			font-size: 16px;
			user-select: none;
			pointer-events: none;
		}
		
		.social-links {
			position: fixed;
			bottom: 20px;
			left: 20px;
			display: flex;
			flex-direction: column;
			gap: 15px;
			z-index: 999;
		}

		.social-icon {
			display: inline-flex;
			align-items: center;
			justify-content: center;
			width: 50px;
			height: 50px;
			background: rgba(155, 0, 255, 0.1);
			border: 2px solid rgba(255, 0, 255, 0.3);
			border-radius: 10px;
			transition: all 0.3s ease;
			text-decoration: none;
			color: white;
			font-size: 24px;
		}

		.social-icon:hover {
			background: rgba(155, 0, 255, 0.3);
		}
		
		.menu-toggle {
			position: fixed;
			top: 20px;
			right: 20px;
			width: 50px;
			height: 50px;
			background: rgba(155, 0, 255, 0.1);
			backdrop-filter: blur(10px);
			border: 2px solid rgba(255, 0, 255, 0.3);
			border-radius: 10px;
			display: flex;
			align-items: center;
			justify-content: center;
			font-size: 24px;
			cursor: pointer;
			transition: all 0.3s ease;
			z-index: 1001;
		}

		.menu-toggle:hover {
			background: rgba(155, 0, 255, 0.3);
		}

		.side-menu {
			position: fixed;
			top: 0;
			right: -400px;
			width: 400px;
			height: 100vh;
			background: rgba(18, 2, 28, 0.98);
			backdrop-filter: blur(10px);
			border-left: 2px solid rgba(255, 0, 255, 0.3);
			transition: right 0.3s ease;
			z-index: 1000;
			overflow-y: auto;
			padding: 80px 20px 20px 20px;
		}

		.side-menu.open {
			right: 0;
		}

		.side-menu h2 {
			font-size: 28px;
			margin-bottom: 20px;
			text-align: center;
			font-weight: normal;
		}

		.item-category {
			margin-bottom: 30px;
		}

		.item-category h3 {
			font-size: 20px;
			margin-bottom: 15px;
			padding: 10px;
			background: rgba(155, 0, 255, 0.2);
			border: 2px solid rgba(255, 0, 255, 0.3);
			border-radius: 8px;
			font-weight: normal;
		}

		.item-list {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
			gap: 10px;
		}

		.item-card {
			background: rgba(155, 0, 255, 0.2);
			border: 2px solid rgba(255, 0, 255, 0.3);
			border-radius: 8px;
			padding: 10px;
			display: flex;
			flex-direction: column;
			align-items: center;
			gap: 8px;
			transition: all 0.2s ease;
		}

		.item-card img {
			width: 50px;
			height: 50px;
			object-fit: contain;
		}

		.item-card span {
			font-size: 12px;
			text-align: center;
			word-wrap: break-word;
		}

		.menu-overlay {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0, 0, 0, 0.5);
			display: none;
			z-index: 999;
		}

		.menu-overlay.show {
			display: block;
		}
		.social-icon img,
		.menu-toggle img {
			width: 24px;
			height: 24px;
			filter: brightness(0) invert(1);
		}

		html {
			background: rgba(18, 2, 27, 1);
		}

		::-webkit-scrollbar {
			width: 12px;
		}

		::-webkit-scrollbar-thumb {
			background: rgba(255, 0, 255, 0.4);
			border-radius: 10px;
		}

		::-webkit-scrollbar-thumb:hover {
			background: rgba(255, 0, 255, 0.6);
		}

		* {
			scrollbar-width: thin;
			scrollbar-color: rgba(255, 0, 255, 0.4) rgba(18, 2, 27, 1);
		}
		
		@media (max-width: 768px) {
			.game-container {
				padding: 15px;
			}
			
			.guess-row,
			.guess-header {
				grid-template-columns: 60px 1.5fr 1fr 1fr 1fr 1fr;
				gap: 5px;
				padding: 10px;
				font-size: 12px;
			}
			
			.item-icon {
				width: 48px;
				height: 48px;
			}
			
			.guess-cell {
				padding: 8px;
				min-height: 48px;
			}
		}

		@media (max-width: 480px) {
			.guess-row,
			.guess-header {
				grid-template-columns: 50px 1fr 0.8fr 0.8fr 0.8fr 0.8fr;
				gap: 3px;
				padding: 8px;
				font-size: 10px;
			}
		}
    </style>
</head>
<body>
    <header>
        <h1>Nubble</h1>
        <div class="subtitle">Guess the item from the HIT GAME Nubby's Number Factory!</div>
    </header>
	
	<div class="menu-toggle" onclick="toggleMenu()"><img src="assets/items.svg" alt="Items"></div>
	<div class="menu-overlay" id="menuOverlay" onclick="toggleMenu()"></div>
	<div class="side-menu" id="sideMenu">
		<h2>All Items</h2>
		<div id="itemCategories"></div>
	</div>

    <div class="game-container">
        <div class="attempts" id="attempts">Attempts: 0/6</div>

        <div class="toggles-container">
			<div class="toggle-item" onclick="document.getElementById('toggleNormal').click()">
				<input type="checkbox" id="toggleNormal" checked onchange="updateAvailableItems()">
				<label for="toggleNormal">Normal Items</label>
			</div>
			<div class="toggle-item" onclick="document.getElementById('toggleFood').click()">
				<input type="checkbox" id="toggleFood" onchange="updateAvailableItems()">
				<label for="toggleFood">Food Items</label>
			</div>
			<div class="toggle-item" onclick="document.getElementById('toggleCorrupted').click()">
				<input type="checkbox" id="toggleCorrupted" onchange="updateAvailableItems()">
				<label for="toggleCorrupted">Corrupted Items</label>
			</div>
			<div class="toggle-item" onclick="document.getElementById('toggleEvil').click()">
				<input type="checkbox" id="toggleEvil" onchange="updateAvailableItems()">
				<label for="toggleEvil">Evil Items</label>
			</div>
		</div>

        <div class="search-container">
            <input 
                type="text" 
                id="searchInput" 
                placeholder="Search for an item..."
                autocomplete="off"
            >
            <div class="dropdown" id="dropdown"></div>
        </div>

        <div class="guesses-container">
            <div class="guess-header">
                <div>Icon</div>
                <div>Item Name</div>
                <div>Type</div>
                <div>Rarity</div>
                <div>Trigger</div>
                <div>Price</div>
            </div>
            <div id="guesses"></div>
        </div>

        <button class="new-game-btn" onclick="newGame()">New Game</button>
    </div>
	
	<div class="social-links">
		<a href="https://x.com/CatTrained" target="_blank" class="social-icon" title="X">
			<img src="assets/x.svg" alt="X">
		</a>
		<a href="https://steamcommunity.com/id/TrainedCatSmuggler/" target="_blank" class="social-icon" title="Steam">
			<img src="assets/steam.svg" alt="Steam">
		</a>
		<a href="https://github.com/TrainedCatSmuggler/Nubble" target="_blank" class="social-icon" title="GitHub">
			<img src="assets/github.svg" alt="GitHub">
		</a>
	</div>

    <div class="message" id="message"></div>

    <script>
        // ITEM DATABASE
        const ITEMS = [
			// NORMAL ITEMS
            { name: "Pants", type: "Normal", rarity: "Common", sellPrice: 5, trigger: "10 pegs popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Pants.webp" },
            { name: "Cactus", type: "Normal", rarity: "Common", sellPrice: 6, trigger: "5 pegs popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Cactus.webp" },
            { name: "Flame Thrower", type: "Normal", rarity: "Common", sellPrice: 7, trigger: "Every 1 second", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Flamethrower.webp" },
            { name: "Monstrosity", type: "Normal", rarity: "Common", sellPrice: 6, trigger: "Every 1.5 seconds", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Monstrosity.webp" },
            { name: "Crazy Straw", type: "Normal", rarity: "Common", sellPrice: 9, trigger: "10 pegs popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_CrazyStraw.webp" },
            { name: "Evil Goose", type: "Normal", rarity: "Common", sellPrice: 5, trigger: "Peg halved", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_EvilGoose.webp" },
            { name: "Flaming Skull", type: "Normal", rarity: "Common", sellPrice: 8, trigger: "Nubby dies", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_FlamingSkull.webp" },
            { name: "Sea Cucumber", type: "Normal", rarity: "Common", sellPrice: 7, trigger: "Nubby dies", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_SeaCucumber.webp" },
            { name: "Pedro", type: "Normal", rarity: "Common", sellPrice: 6, trigger: "Nubby hits wall", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Pedro.webp" },
            { name: "Finger Puppet", type: "Normal", rarity: "Common", sellPrice: 5, trigger: "Nubby bounces", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_FingerPuppet.webp" },
            { name: "Jacks", type: "Normal", rarity: "Common", sellPrice: 6, trigger: "Pass round goal", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Jacks.webp" },
            { name: "1 Ton of Feathers", type: "Normal", rarity: "Common", sellPrice: 5, trigger: "Peg fully popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_TonOfFeathers.webp" },
            { name: "Dancing Dino", type: "Normal", rarity: "Common", sellPrice: 8, trigger: "Nubby bounces", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_DancingDinosaur.webp" },
            { name: "Squirmy", type: "Normal", rarity: "Common", sellPrice: 5, trigger: "5 pegs popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Squirmy.webp" },
            { name: "Broken Socket", type: "Normal", rarity: "Common", sellPrice: 7, trigger: "Item to the right of me triggers", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_BrokenSocket.webp" },
            { name: "Kazoo", type: "Normal", rarity: "Common", sellPrice: 7, trigger: "Every 1.5 seconds", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Kazoo.webp" },
			{ name: "Uranium Rod", type: "Normal", rarity: "Common", sellPrice: 7, trigger: "First peg popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_UraniumRod.webp" },
            { name: "Happy Seal", type: "Normal", rarity: "Common", sellPrice: 7, trigger: "8 pegs popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_HappySeal.webp" },
            { name: "Friendly Rock", type: "Normal", rarity: "Common", sellPrice: 7, trigger: "Nubby hits wall twice", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_FriendlyRock.webp" },
			{ name: "Tardigrade", type: "Normal", rarity: "Common", sellPrice: 8, trigger: "Peg halved", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Tardigrade.webp" },
            { name: "Plastic Tree", type: "Normal", rarity: "Common", sellPrice: 7, trigger: "Every 1.5 seconds", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_PlasticTree.webp" },
            { name: "Cheese House", type: "Normal", rarity: "Common", sellPrice: 8, trigger: "Nubby dies", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_CheeseHouse.webp" },
			{ name: "Disguise Glasses", type: "Normal", rarity: "Common", sellPrice: 7, trigger: "Highest # peg popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_DisguiseGlasses.webp" },
            { name: "Two Headed Turtle", type: "Normal", rarity: "Common", sellPrice: 8, trigger: "10 pegs popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_TwoHeadedTurtle.webp" },
			{ name: "Poop Butt", type: "Normal", rarity: "Common", sellPrice: 7, trigger: "First peg popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_PoopButt.webp" },
            { name: "E-Block", type: "Normal", rarity: "Common", sellPrice: 8, trigger: "Force trigger this item", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_EBlock.webp" },
            { name: "T-Block", type: "Normal", rarity: "Common", sellPrice: 7, trigger: "Force trigger this item", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_TBlock.webp" },
			{ name: "Lobster Claw", type: "Normal", rarity: "Rare", sellPrice: 11, trigger: "Every 3 seconds", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_LobsterClaw.webp" },
            { name: "Nose", type: "Normal", rarity: "Rare", sellPrice: 10, trigger: "Pass round goal", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Nose.webp" },
			{ name: "Rubber Chicken", type: "Normal", rarity: "Rare", sellPrice: 11, trigger: "Every 0.5 seconds", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_RubberChicken.webp" },
            { name: "Yeti", type: "Normal", rarity: "Rare", sellPrice: 10, trigger: "First peg popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Yeti.webp" },
            { name: "Squid", type: "Normal", rarity: "Rare", sellPrice: 10, trigger: "Nubby launched", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Squid.webp" },
			{ name: "Laser Pointer", type: "Normal", rarity: "Rare", sellPrice: 12, trigger: "2 pegs halved", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_LaserPointer.webp" },
            { name: "All-Seeing Pyramid", type: "Normal", rarity: "Rare", sellPrice: 10, trigger: "Nubby dies", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_AllSeeingPyramid.webp" },
			{ name: "Inflatable Dolphin", type: "Normal", rarity: "Rare", sellPrice: 11, trigger: "Nubby dies", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_InflatableDolphin.webp" },
            { name: "3D-Glasses", type: "Normal", rarity: "Ultra Rare", sellPrice: 10, trigger: "First peg popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_3DGlasses.webp" },
            { name: "Horse Pill", type: "Normal", rarity: "Ultra Rare", sellPrice: 10, trigger: "Pass round goal", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_HorsePill.webp" },
			// ODD ITEMS
			{ name: "Rabid Monstrosity", type: "Normal", rarity: "Common", sellPrice: 6, trigger: "First peg popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_MonstrosityRabid.webp" },
            { name: "Flutty", type: "Normal", rarity: "Common", sellPrice: 7, trigger: "2 pegs popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Flutty.webp" },
            { name: "The Mollusk", type: "Normal", rarity: "Common", sellPrice: 5, trigger: "Nubby launched", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Mollusk.webp" },
			// FOOD ITEMS
			{ name: "Strawberry", type: "Food", rarity: "Common", sellPrice: 3, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Strawberry.webp" },
            { name: "HotDog-Dog", type: "Food", rarity: "Common", sellPrice: 3, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_HotDogDog.webp" },
            { name: "Shish Kebab", type: "Food", rarity: "Common", sellPrice: 10, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Kebab.webp" },
			{ name: "Kidney Bean", type: "Food", rarity: "Common", sellPrice: 9, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_KidneyBean.webp" },
            { name: "Pickle Rat", type: "Food", rarity: "Common", sellPrice: 4, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_PickleRat.webp" },
            { name: "Josh Jelly", type: "Food", rarity: "Common", sellPrice: 7, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Jelly.webp" },
			{ name: "Chip", type: "Food", rarity: "Common", sellPrice: 11, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Chip.webp" },
            { name: "Soup Crackers", type: "Food", rarity: "Common", sellPrice: 18, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_SoupCrackers.webp" },
            { name: "Tri-Bagel", type: "Food", rarity: "Common", sellPrice: 12, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_TriBagel.webp" },
			{ name: "Noodle", type: "Food", rarity: "Rare", sellPrice: 6, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Noodle.webp" },
			{ name: "Tart Lard", type: "Food", rarity: "Rare", sellPrice: 18, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_TartLard.webp" },
			{ name: "Croissant", type: "Food", rarity: "Rare", sellPrice: 17, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Croissant.webp" },
			{ name: "Dave", type: "Food", rarity: "Rare", sellPrice: 0, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Dave.webp" },
			{ name: "Lentil", type: "Food", rarity: "Rare", sellPrice: 11, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Lentil.webp?d805e5" },
			{ name: "Avocado", type: "Food", rarity: "Rare", sellPrice: 9, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Avocado.webp" },
			{ name: "Fava Bean", type: "Food", rarity: "Rare", sellPrice: 17, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_FavaBean.webp" },
			{ name: "Donut", type: "Food", rarity: "Ultra Rare", sellPrice: 20, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Donut.webp" },
			{ name: "Starfruit", type: "Food", rarity: "Ultra Rare", sellPrice: 16, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Starfruit.webp" },
			// ODD FOOD ITEMS
			{ name: "Moldy Sandwich", type: "Food", rarity: "Common", sellPrice: 8, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_MoldySandwich.webp" },
            { name: "Broken Chip", type: "Food", rarity: "Common", sellPrice: 11, trigger: "Eat", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_ChipBroken.webp" },
			// CORRUPTED ITEMS
			{ name: "Jake the Snake", type: "Corrupted", rarity: "Common", sellPrice: 6, trigger: "First peg popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_JakeTheSnake.webp" },
			{ name: "Toy Fish", type: "Corrupted", rarity: "Common", sellPrice: 10, trigger: "First peg popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_ToyFish.webp" },
			{ name: "The Pointer", type: "Corrupted", rarity: "Common", sellPrice: 11, trigger: "Peg fully popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_ThePointer.webp" },
			{ name: "Asbestos", type: "Corrupted", rarity: "Common", sellPrice: 9, trigger: "5 pegs halved", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Asbestos.webp" },
			{ name: "Wingless Fly", type: "Corrupted", rarity: "Common", sellPrice: 13, trigger: "First peg popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_WinglessFly.webp" },
			{ name: "Mannequin Head", type: "Corrupted", rarity: "Common", sellPrice: 14, trigger: "First peg popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_MannequinHead.webp" },
			{ name: "Ouroboros", type: "Corrupted", rarity: "Common", sellPrice: 15, trigger: "First peg popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Ouroboros.webp" },
			{ name: "Alien", type: "Corrupted", rarity: "Common", sellPrice: 6, trigger: "2 pegs doubled", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Alien.webp" },
			{ name: "Fly Agaric", type: "Corrupted", rarity: "Rare", sellPrice: 16, trigger: "Nubby hits wall twice", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_FlyAgaric.webp" },
			{ name: "Clay-Man-Guy", type: "Corrupted", rarity: "Rare", sellPrice: 14, trigger: "Every 0.5 seconds", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_ClayManGuy.webp" },
			{ name: "King Baby", type: "Corrupted", rarity: "Rare", sellPrice: 16, trigger: "Every 1.5 seconds", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_KingBaby.webp" },
			{ name: "Fish Man", type: "Corrupted", rarity: "Rare", sellPrice: 20, trigger: "Every 1 second", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_FishMan.webp" },
			{ name: "Pregnancy Test", type: "Corrupted", rarity: "Rare", sellPrice: 20, trigger: "First peg popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_PregnancyTest.webp" },
			{ name: "Flibby Flabbies", type: "Corrupted", rarity: "Rare", sellPrice: 15, trigger: "First peg popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_FlibbyFlobbies.webp" },
			// EVIL ITEMS
			{ name: "Antimatter", type: "Evil", rarity: "Common", sellPrice: 0, trigger: "Peg doubled", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Antimatter.webp" },
            { name: "Dollhead", type: "Evil", rarity: "Common", sellPrice: 0, trigger: "Pass round goal", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_DollHead.webp" },
			{ name: "Psychic Spider", type: "Evil", rarity: "Common", sellPrice: 0, trigger: "Every 1 second", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_PsychicSpider.webp" },
            { name: "Homunculus", type: "Evil", rarity: "Common", sellPrice: 0, trigger: "Nubby hits wall 5 times", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Homunculus.webp" },
			{ name: "Alphamunculus", type: "Evil", rarity: "Common", sellPrice: 0, trigger: "Nubby hits wall 5 times", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_Alphamunculus.webp" },
            { name: "Broken Figurine", type: "Evil", rarity: "Common", sellPrice: 0, trigger: "Force trigger this item", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_BrokenFigurine.webp" },
			{ name: "Scary Fingore", type: "Evil", rarity: "Common", sellPrice: 0, trigger: "Every 1.5 seconds", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_HairyFingore.webp" },
            { name: "Bottled Tears", type: "Evil", rarity: "Common", sellPrice: 0, trigger: "First peg popped", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_BottledTears.webp" },
			{ name: "Rodent Bones", type: "Evil", rarity: "Common", sellPrice: 0, trigger: "Every 1 second", icon: "https://nubbysnumberfactory.wiki.gg/images/Item_RodentBones.webp" },
		];

        let targetItem;
        let guesses = [];
        let gameOver = false;
        const MAX_ATTEMPTS = 6;
        let availableItems = [...ITEMS];
        let gameStartItems = [...ITEMS]; // Items that were available when the game started

        function updateAvailableItems() {
            const includeNormal = document.getElementById('toggleNormal').checked;
            const includeFood = document.getElementById('toggleFood').checked;
            const includeCorrupted = document.getElementById('toggleCorrupted').checked;
            const includeEvil = document.getElementById('toggleEvil').checked;

            // If nothing is checked, check Normal by default
            if (!includeNormal && !includeFood && !includeCorrupted && !includeEvil) {
                document.getElementById('toggleNormal').checked = true;
                return;
            }

            availableItems = ITEMS.filter(item => {
                if (item.type === 'Normal' && includeNormal) return true;
                if (item.type === 'Food' && includeFood) return true;
                if (item.type === 'Corrupted' && includeCorrupted) return true;
                if (item.type === 'Evil' && includeEvil) return true;
                return false;
            });

            if (targetItem) {
                showMessage('Toggle changes will apply on the next game');
            }
        }

        function selectRandomItem() {
            return availableItems[Math.floor(Math.random() * availableItems.length)];
        }

        function showMessage(text, type = '') {
            const msg = document.getElementById('message');
            msg.textContent = text;
            msg.className = 'message show ' + type;
            setTimeout(() => msg.classList.remove('show'), 3000);
        }

        function updateAttempts() {
            document.getElementById('attempts').textContent = `Attempts: ${guesses.length}/${MAX_ATTEMPTS}`;
        }

        function filterItems(searchTerm) {
            if (!searchTerm) return [];
            return gameStartItems.filter(item => 
                item.name.toLowerCase().includes(searchTerm.toLowerCase())
            );
        }

        function updateDropdown(items) {
            const dropdown = document.getElementById('dropdown');
            dropdown.innerHTML = '';
            
            if (items.length === 0) {
                dropdown.classList.remove('show');
                return;
            }

            items.forEach(item => {
                const div = document.createElement('div');
                div.className = 'dropdown-item';
                
                const img = document.createElement('img');
                img.src = item.icon;
                img.className = 'dropdown-item-icon';
                img.alt = item.name;
                
                const span = document.createElement('span');
                span.textContent = item.name;
                
                div.appendChild(img);
                div.appendChild(span);
                div.onclick = () => selectItem(item);
                dropdown.appendChild(div);
            });

            dropdown.classList.add('show');
        }

        function selectItem(item) {
            if (gameOver || guesses.length >= MAX_ATTEMPTS) return;

            // Check if already guessed
            if (guesses.some(g => g.name === item.name)) {
                showMessage('You already guessed that item!');
                return;
            }

            guesses.push(item);
            updateAttempts();
            renderGuess(item);

            document.getElementById('searchInput').value = '';
            document.getElementById('dropdown').classList.remove('show');

            // Check win condition
            if (item.name === targetItem.name) {
                gameOver = true;
                showMessage(`You guessed ${targetItem.name}!`, 'win');
            } else if (guesses.length >= MAX_ATTEMPTS) {
                gameOver = true;
                showMessage(`Game Over! The item was ${targetItem.name}`, 'lose');
            }
        }

        function compareTriggers(guessTrigger, targetTrigger) {
            // Exact match = green
            if (guessTrigger === targetTrigger) {
                return 'correct';
            }
            
            // Check if both triggers contain numbers (including decimals)
            const guessHasNumber = /[\d.]+/.test(guessTrigger);
            const targetHasNumber = /[\d.]+/.test(targetTrigger);
            
            // Only check for partial match if both have numbers
            if (guessHasNumber && targetHasNumber) {
                // Extract the base trigger (remove all numbers and decimals)
                let guessBase = guessTrigger.replace(/[\d.]+/g, '').trim();
                let targetBase = targetTrigger.replace(/[\d.]+/g, '').trim();
                
                // Normalize by removing trailing 's' to handle plural/singular differences
                guessBase = guessBase.replace(/s\s*$/, '');
                targetBase = targetBase.replace(/s\s*$/, '');
                
                // If the base trigger matches (but numbers are different) = yellow
                if (guessBase === targetBase && guessBase.length > 0) {
                    return 'close';
                }
            }
            
            // Otherwise = gray
            return 'incorrect';
        }

        function renderGuess(item) {
            const guessesDiv = document.getElementById('guesses');
            const row = document.createElement('div');
            row.className = 'guess-row';

            // Item Icon
            const iconCell = document.createElement('div');
            iconCell.className = 'guess-cell';
            iconCell.style.background = 'transparent';
            iconCell.style.display = 'flex';
            iconCell.style.justifyContent = 'center';
            iconCell.style.alignItems = 'center';
            
            const img = document.createElement('img');
            img.src = item.icon;
            img.className = 'item-icon';
            img.alt = item.name;
            
            // Add error handling for images
            img.onerror = function() {
                console.error('Failed to load image:', item.icon);
                // Replace with placeholder text if image fails
                const placeholder = document.createElement('div');
                placeholder.className = 'item-icon-placeholder';
                placeholder.textContent = '?';
                iconCell.innerHTML = '';
                iconCell.appendChild(placeholder);
            };
            
            iconCell.appendChild(img);
            row.appendChild(iconCell);

            // Item Name
            const nameCell = document.createElement('div');
            nameCell.className = 'guess-cell item-name ' + 
                (item.name === targetItem.name ? 'correct' : 'incorrect');
            nameCell.textContent = item.name;
            row.appendChild(nameCell);

            // Type
            const typeCell = document.createElement('div');
            typeCell.className = 'guess-cell ' + 
                (item.type === targetItem.type ? 'correct' : 'incorrect');
            typeCell.textContent = item.type;
            row.appendChild(typeCell);

            // Rarity
            const rarityCell = document.createElement('div');
            rarityCell.className = 'guess-cell ' + 
                (item.rarity === targetItem.rarity ? 'correct' : 'incorrect');
            rarityCell.textContent = item.rarity;
            row.appendChild(rarityCell);

            // Trigger (with smart matching)
            const triggerCell = document.createElement('div');
            const triggerMatch = compareTriggers(item.trigger, targetItem.trigger);
            triggerCell.className = 'guess-cell ' + triggerMatch;
            triggerCell.textContent = item.trigger;
            row.appendChild(triggerCell);

            // Price (with close detection)
            const priceCell = document.createElement('div');
            const priceDiff = Math.abs(item.sellPrice - targetItem.sellPrice);
            let priceClass;
            if (item.sellPrice === targetItem.sellPrice) {
                priceClass = 'correct';
            } else if (priceDiff === 1) {
                priceClass = 'close';
            } else {
                priceClass = 'incorrect';
            }
            priceCell.className = 'guess-cell ' + priceClass;
            const priceText = document.createElement('span');
			priceText.textContent = item.sellPrice;

			const coinImg = document.createElement('img');
			coinImg.src = 'https://nubbysnumberfactory.wiki.gg/images/Sprite_coin.png';
			coinImg.style.width = '20px';
			coinImg.style.height = '20px';
			coinImg.style.marginLeft = '5px';
			coinImg.alt = 'coin';

			priceCell.appendChild(priceText);
			priceCell.appendChild(coinImg);
			row.appendChild(priceCell);

            guessesDiv.appendChild(row);
        }

        function newGame() {
            gameStartItems = [...availableItems];
            
            targetItem = selectRandomItem();
            guesses = [];
            gameOver = false;
            document.getElementById('guesses').innerHTML = '';
            document.getElementById('searchInput').value = '';
            document.getElementById('dropdown').classList.remove('show');
            updateAttempts();
        }
		
		function toggleMenu() {
			const menu = document.getElementById('sideMenu');
			const overlay = document.getElementById('menuOverlay');
			menu.classList.toggle('open');
			overlay.classList.toggle('show');
		}

		function populateItemMenu() {
			const categories = {
				'Normal': [],
				'Food': [],
				'Corrupted': [],
				'Evil': []
			};

			// Group items by type
			ITEMS.forEach(item => {
				if (categories[item.type]) {
					categories[item.type].push(item);
				}
			});

			const container = document.getElementById('itemCategories');
			container.innerHTML = '';

			// Create sections for each category
			Object.keys(categories).forEach(categoryName => {
				if (categories[categoryName].length > 0) {
					const categoryDiv = document.createElement('div');
					categoryDiv.className = 'item-category';

					const header = document.createElement('h3');
					header.textContent = `${categoryName} Items (${categories[categoryName].length})`;
					categoryDiv.appendChild(header);

					const itemList = document.createElement('div');
					itemList.className = 'item-list';

					categories[categoryName].forEach(item => {
						const card = document.createElement('div');
						card.className = 'item-card';

						const img = document.createElement('img');
						img.src = item.icon;
						img.alt = item.name;
						img.onerror = function() {
							this.style.display = 'none';
						};

						const name = document.createElement('span');
						name.textContent = item.name;

						card.appendChild(img);
						card.appendChild(name);
						itemList.appendChild(card);
					});

					categoryDiv.appendChild(itemList);
					container.appendChild(categoryDiv);
				}
			});
		}

        // Event listeners
        document.getElementById('searchInput').addEventListener('input', (e) => {
            const searchTerm = e.target.value;
            const filtered = filterItems(searchTerm);
            updateDropdown(filtered);
        });

        document.getElementById('searchInput').addEventListener('focus', (e) => {
            const searchTerm = e.target.value;
            if (searchTerm) {
                const filtered = filterItems(searchTerm);
                updateDropdown(filtered);
            }
        });

        // Close dropdown when clicking outside
        document.addEventListener('click', (e) => {
            if (!e.target.closest('.search-container')) {
                document.getElementById('dropdown').classList.remove('show');
            }
        });

        // Initialize game
		populateItemMenu();
        updateAvailableItems();
        newGame();
    </script>
</body>
</html>